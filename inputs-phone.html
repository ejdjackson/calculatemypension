<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculate My Pension</title>
    <!-- Bootstrap CSS -->
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        
        
        .hidden {
            visibility: hidden !important;
            opacity: 0 !important;
            transform: translateY(-50px) !important;
            position: absolute !important;
            transition: opacity 1s ease, transform 1s ease !important;
        }

        .visible {
            visibility: visible;
            opacity: 1;
            transform: translateY(0);
            transition: opacity 0.5s ease, transform 0.5s ease;
            position: relative; /* Adjust as needed */
        }

        .three-way-toggle {
        display: flex;
        justify-content: space-between;
        align-items: center;
        /* width: 410px; */
        width: fit-content;
        height: 55px;
        background-color: #f0f0f0;
        border-radius: 15px;
        /* padding: 5px; */
        padding: 8px;
        position: relative;
        margin-top: 15px;
        margin-bottom: 20px;
        margin-left: 20px;
        
        }

        .three-way-toggle input[type="radio"] {
        display: none;
        }

        .three-way-toggle label {
        flex: 1;
        text-align: center;
        width: fit-content;
        padding: 10px;
        cursor: pointer;
        transition: background-color 0.3s ease, color 0.3s ease;
        border-radius: 15px;
        }

        .three-way-toggle label:hover {
        background-color: #e0e0e0;
        }

        .three-way-toggle input[type="radio"]:checked + label {
        background-color:  #3e8e41;
        color: white;
        }

        /* Selected styles for Option 1 */
        .three-way-toggle input#option3:checked ~ .three-way-toggle {
        background-color: #4CAF50; /* Green background for Option 1 */
        }

        .three-way-toggle input#option3:checked + label {
        background-color: #4CAF50; /* Green label for Option 1 */
        color: white;
        }

        /* Selected styles for Option 2 */
        .three-way-toggle input#option1:checked ~ .three-way-toggle {
        background-color: #FF9800; /* Orange background for Option 2 */
        }

        .three-way-toggle input#option1:checked + label {
        background-color: #FF9800; /* Orange label for Option 2 */
        color: white;
        }

        /* Selected styles for Option 3 */
        .three-way-toggle input#option2:checked ~ .three-way-toggle {
        background-color: #2196F3; /* Blue background for Option 3 */
        }

        .three-way-toggle input#option2:checked + label {
        background-color: #2196F3; /* Blue label for Option 3 */
        color: white;
        }

        .result-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        .result-label {
            
            margin-right: 10px;
        }
        .result-output {
            
            border: 1px solid #ddd;
            padding: 5px 10px;
            border-radius: 5px;
            width: 25vw;
            text-align: right;
            background-color: #f9f9f9;
        }


        
    </style>
    
   
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand d-flex align-items-center" href="navbar-icon.png">
                <div class="logo-icon me-2"></div>
                <span class="custom-navbar-text" style="padding-right: 15vh; overflow: hidden;">Calculate My Pension</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="inputs.html">Inputs</a></li>
                    <li class="nav-item"><a class="nav-link" href="FAQ.html">FAQs</a></li>
                    <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mt-4">
       
        <h2 style="text-align: center;">Inputs</h2>

        <!-- Accordion: Inputs -->
        <div class="accordion mb-4" id="inputsAccordion">
    
            <div class="accordion-body">
                <!-- Nested Accordion: Sections -->
                <div class="accordion" id="userSectionsAccordion">
                    
                    <!-- Section: Your Current Situation -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingCurrentSituation">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseCurrentSituation" aria-expanded="false" aria-controls="collapseCurrentSituation" >
                                Your Current Situation
                            </button>
                        </h2>
                        <div id="collapseCurrentSituation" class="accordion-collapse collapse" aria-labelledby="headingCurrentSituation" data-bs-parent="#userSectionsAccordion">
                            <div class="accordion-body">
                                <form>
                                    <div class="mb-3">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <!-- Label -->
                                            <label for="currentAgeSlider" class="form-label mb-0" style="min-width: 150px;">Current Age</label>
                                            <!-- Output Box -->
                                            <output id="currentAgePhone" class="form-control text-end" style="max-width: 25vw; min-width: 20vw;">20</output>
                                        </div>
                                        <!-- Slider -->
                                        <input type="range" class="form-range mt-3" id="currentAgeSlider" min="20" max="67" value="20" oninput="updateOutput('currentAgePhone', this.value)" style="padding: 10px 0; border-color: #2b2b2b;">
                                    </div>
                                    <div class="mb-3">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <!-- Label -->
                                            <label for="currentFundPhone" class="form-label mb-0" style="min-width: 150px;">Current Pension Fund (£)</label>
                                            <!-- Output Box -->
                                            <output id="currentFundPhone" class="form-control text-end" style="max-width: 25vw; min-width: 20vw;">0</output>
                                        </div>
                                        <!-- Slider -->
                                        <input type="range" class="form-range mt-3" id="currentFundSlider" min="0" max="1000000" step="1000" value="0" oninput="updateOutput('currentFundPhone', this.value)">
                                    </div>
                                    
                                    <div class="mb-3">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <!-- Label -->
                                            <label for="currentISAPhone" class="form-label mb-0" style="min-width: 150px;">Current ISA Holdings (£)</label>
                                            <!-- Output Box -->
                                            <output id="currentISAPhone" class="form-control text-end" style="max-width: 25vw; min-width: 20vw;">0</output>
                                        </div>
                                        <!-- Slider -->
                                        <input type="range" class="form-range mt-3" id="currentISASlider" min="0" max="500000" step="1000" value="0" oninput="updateOutput('currentISAPhone', this.value)">
                                    </div>
                                    
                                    
                                </form>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Section: Future Contributions -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingFutureContributions">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFutureContributions" aria-expanded="false" aria-controls="collapseFutureContributions" >
                                Future Contributions
                            </button>
                        </h2>
                        <div id="collapseFutureContributions" class="accordion-collapse collapse" aria-labelledby="headingFutureContributions" data-bs-parent="#userSectionsAccordion">
                            <div class="accordion-body">
                                <form>
                                    <div class="mb-3">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <!-- Label -->
                                            <label for="inputMonthlyContributionPhone" class="form-label mb-0" style="min-width: 150px;">Monthly Pension Contributions (£)</label>
                                            <!-- Output Box -->
                                            <output id="inputMonthlyContributionPhone" class="form-control text-end" style="max-width: 25vw; min-width: 20vw;">0</output>
                                        </div>
                                        <!-- Slider -->
                                        <input type="range" class="form-range mt-3" id="monthlyPensionContributionsSlider" min="0" max="5000" step="10" value="0" oninput="updateOutput('inputMonthlyContributionPhone', this.value)">
                                    </div>
                                    
                                    <div class="mb-3">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <!-- Label -->
                                            <label for="inputMonthlyISAContributionPhone" class="form-label mb-0" style="min-width: 150px;">Monthly ISA Deposits (£)</label>
                                            <!-- Output Box -->
                                            <output id="inputMonthlyISAContributionPhone" class="form-control text-end" style="max-width: 25vw; min-width: 20vw;">0</output>
                                        </div>
                                        <!-- Slider -->
                                        <input type="range" class="form-range mt-3" id="monthlyISADepositsSlider" min="0" max="1666" step="10" value="0" oninput="updateOutput('inputMonthlyISAContributionPhone', this.value)">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <!-- Section: Defined Benefit Pension -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingDefinedBenefit">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseDefinedBenefit" aria-expanded="false" aria-controls="collapseDefinedBenefit" >
                                Defined Benefit Pension
                            </button>
                        </h2>
                        <div id="collapseDefinedBenefit" class="accordion-collapse collapse" aria-labelledby="headingDefinedBenefit" data-bs-parent="#userSectionsAccordion">
                            <div class="accordion-body">
                                <form>
                                    <div class="mb-3">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <!-- Label -->
                                            <label for="dbPensionAmountPhone" class="form-label mb-0" style="min-width: 150px;">Annual Pension Amount (£)</label>
                                            <!-- Output Box -->
                                            <output id="dbPensionAmountPhone" class="form-control text-end" style="max-width: 25vw; min-width: 20vw;">0</output>
                                        </div>
                                        <!-- Slider -->
                                        <input type="range" class="form-range mt-3" id="annualPensionSlider" min="0" max="150000" step="100" value="0" oninput="updateOutput('dbPensionAmountPhone', this.value)">
                                    </div>
                                    
                                    <div class="mb-3">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <!-- Label -->
                                            <label for="dbPensionAgePhone" class="form-label mb-0" style="min-width: 150px;">Payable From Age</label>
                                            <!-- Output Box -->
                                            <output id="dbPensionAgePhone" class="form-control text-end" style="max-width: 25vw; min-width: 20vw;">55</output>
                                        </div>
                                        <!-- Slider -->
                                        <input type="range" class="form-range mt-3" id="pensionPayableAgeSlider" min="50" max="75" step="1" value="55" oninput="updateOutput('dbPensionAgePhone', this.value)">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End Nested Accordion -->

                
                

                                
                    <!-- Section: Your Retirement Income Goals -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingRetirementGoals">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseRetirementGoals" aria-expanded="false" aria-controls="collapseRetirementGoals" >
                                Your Retirement Income Goals
                            </button>
                        </h2>
                        <div id="collapseRetirementGoals" class="accordion-collapse collapse" aria-labelledby="headingRetirementGoals" data-bs-parent="#userSectionsAccordion">
                            <div class="accordion-body">
                                <form>
        
                                    
                                    <div class="mb-3">
                                        <p class="form-label">
                                            The <a href="https://www.retirementlivingstandards.org.uk" target="_blank">Retirement Living Standards</a> website offers a practical framework to help you estimate the income needed for your desired lifestyle in retirement. Select a standard of living or enter your own desired retirement income (in today's terms).
                                        </p>
                                        <div class="three-way-toggle" id="livingStandardsTogglePhone">
                                            <input type="radio" id="option1" name="togglePhone" value="Option 1" checked>
                                            <label for="option1">  Minimum  </label>
                                            
                                            <input type="radio" id="option2" name="togglePhone" value="Option 2">
                                            <label for="option2"> Moderate  </label>
                                            
                                            <input type="radio" id="option3" name="togglePhone" value="Option 3">
                                            <label for="option3">Comfortable</label>
                                        </div>
                                        <div class="d-flex justify-content-between align-items-center">
                                            <!-- Label -->
                                            <label for="inputDesiredIncomePhone" class="form-label mb-0" style="min-width: 150px;">Desired Monthly Income (£)</label>
                                            <!-- Output Box -->
                                            <output id="inputDesiredIncomePhone" class="form-control text-end" style="max-width: 25vw; min-width: 20vw;" data-raw-value="0">0</output>
                                        </div>
                                        <!-- Slider -->
                                        <input type="range" class="form-range mt-3" id="desiredIncomeSlider" min="0" max="10000" step="100" value="0" oninput="updateOutput('inputDesiredIncomePhone', this.value)">
                                    </div>

                                    <div class="mb-3">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <!-- Label -->
                                            <label for="inputRetirementAgePhone" class="form-label mb-0" style="min-width: 150px;">Desired Retirement Age</label>
                                            <!-- Output Box -->
                                            <output id="inputRetirementAgePhone" class="form-control text-end" style="max-width: 25vw; min-width: 20vw;">65</output>
                                        </div>
                                        <!-- Slider -->
                                        <input type="range" class="form-range mt-3" id="retirementAgeSlider" min="50" max="75" step="1" value="65" oninput="updateOutput('inputRetirementAgePhone', this.value)">
                                    </div>
                                    
                                    <div class="mb-3">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <!-- Label -->
                                            <label for="inputTaxFreeCashPercentPhone" class="form-label mb-0" style="min-width: 150px;">Tax Free Cash Lump Sum (% of Fund)</label>
                                            <!-- Output Box -->
                                            <output id="inputTaxFreeCashPercentPhone" class="form-control text-end" style="max-width: 25vw; min-width: 20vw;">0</output>
                                        </div>
                                        <!-- Slider -->
                                        <input type="range" class="form-range mt-3" id="taxFreeCashSlider" min="0" max="25" step="1" value="0" oninput="updateOutput('inputTaxFreeCashPercentPhone', this.value)">
                                    </div>

                                   
                                </form>
                            </div>
                        </div>
                    </div>
                    

                    

                    <!-- Section: Assumptions -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingAssumptions">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseAssumptions" aria-expanded="false" aria-controls="collapseAssumptions" >
                                Assumptions
                            </button>
                        </h2>
                        <div id="collapseAssumptions" class="accordion-collapse collapse" aria-labelledby="headingAssumptions" data-bs-parent="#userSectionsAccordion">
                            <div class="accordion-body">
                                <form>
                                    <div class="mb-3">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <!-- Label -->
                                            <label for="fundGrowthSlider" class="form-label mb-0" style="min-width: 150px;">Fund Growth (%)</label>
                                            <!-- Output Box -->
                                            <output id="fundGrowthPhone" class="form-control text-end" style="max-width: 25vw; min-width: 20vw;">5</output>
                                        </div>
                                        <!-- Slider -->
                                        <input type="range" class="form-range mt-3" id="fundGrowthSlider" min="0" max="15" step="0.1" value="5" oninput="updateOutput('fundGrowthPhone', this.value)" style="padding: 10px 0; border-color: #2b2b2b;">
                                    </div>
                                    
                                    <div class="mb-3">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <!-- Label -->
                                            <label for="inflationSlider" class="form-label mb-0" style="min-width: 150px;">Inflation (%)</label>
                                            <!-- Output Box -->
                                            <output id="inflationPhone" class="form-control text-end" style="max-width: 25vw; min-width: 20vw;">2.5</output>
                                        </div>
                                        <!-- Slider -->
                                        <input type="range" class="form-range mt-3" id="inflationSlider" min="0" max="10" step="0.1" value="2.5" oninput="updateOutput('inflationPhone', this.value)" style="padding: 10px 0; border-color: #2b2b2b;">
                                    </div>
                                    
                                    <div class="mb-3">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <!-- Label -->
                                            <label for="fundChargesSlider" class="form-label mb-0" style="min-width: 150px;">Fund Charges (%)</label>
                                            <!-- Output Box -->
                                            <output id="fundChargesPhone" class="form-control text-end" style="max-width: 25vw; min-width: 20vw;">1</output>
                                        </div>
                                        <!-- Slider -->
                                        <input type="range" class="form-range mt-3" id="fundChargesSlider" min="0" max="2.5" step="0.1" value="1" oninput="updateOutput('fundChargesPhone', this.value)" style="padding: 10px 0; border-color: #2b2b2b;">
                                    </div>
                                    
                                    
                                    
                                </form>
                            </div>
                        </div>
                    </div>
                


            </div>
    
        </div>


        


        

     <!-- <div class="d-flex justify-content-center mb-4">
            <button class="btn btn-success btn-lg mb-4"  style="background-color: #4CAF50; "  onclick="saveAndCalc()">Calculate My Pension</button>
        </div> -->
        <h2 style="text-align: center;">Results</h2>

    <!-- Results Section -->
    <div class="container mt-4" style="margin-bottom: 5%;">

        <div class="accordion-body">
            <!-- Nested Accordion: Results Sections -->
            <div class="accordion" id="resultsSectionsAccordion">
                <!-- Section: Fund Values -->
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingFundValues">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFundValues" aria-expanded="false" aria-controls="collapseFundValues" >
                            Fund Values
                        </button>
                    </h2>
                    <div id="collapseFundValues" class="accordion-collapse collapse" aria-labelledby="headingFundValues" data-bs-parent="#resultsSectionsAccordion">
                        <div class="accordion-body">
                            <div class="result-row">
                                <span class="result-label">Pension Fund at Retirement:</span>
                                <div id="pensionFundAtRetirementPhone" class="result-output"></div>
                            </div>
                            <div class="result-row">
                                <span class="result-label">ISA Holdings at Retirement:</span>
                                <div id="ISAHoldingsAtRetirementPhone" class="result-output"></div>
                            </div>
                            <div class="result-row">
                                <span class="result-label" id="TFCTakenTodaysMoneyTextPhone">Tax Free Cash Lump Sum:</span>
                                <div id="taxFreeCashTakenTodaysMoneyPhone" class="result-output"></div>
                            </div>
                            
                        </div>
                    </div>
                </div>
                <!-- Section: Income -->
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingIncome">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseIncome" aria-expanded="false" aria-controls="collapseIncome" >
                            Income
                        </button>
                    </h2>
                    <div id="collapseIncome" class="accordion-collapse collapse" aria-labelledby="headingIncome" data-bs-parent="#resultsSectionsAccordion">
                        
                        

                        <div class="accordion-body">
                            <div class="result-row">
                                <span class="result-label">What You Can Afford:</span>
                                <div id="expectedTotalIncomeTodaysMoneyPhone" class="result-output"></div>
                            </div>
                            <div class="result-row">
                                <span class="result-label" id="desiredMonthlyIncomeAtRetirementTextPhone">What You Need:</span>
                                <div id="desiredMonthlyIncomeAtRetirementPhone" class="result-output"></div>
                            </div>
                            <div class="result-row">
                                <span class="result-label" id="shortfallAtRetirementTextPhone"><strong>Shortfall:</strong></span>
                                <div id="shortfallAtRetirementPhone" class="result-output"></div>
                            </div>
                                                                    
                        </div>

                        <div class="container mt-3">
                            
                            <!-- Yearly/Monthly Switch -->
                            <div class="d-flex justify-content-between align-items-center mb-3 p-2">
                                <label class="form-check-label me-3" for="yearlyMonthlySwitch">Monthly / Yearly</label>
                                <div class="form-check form-switch ms-auto pe-2">
                                    <input class="form-check-input" type="checkbox" id="frequencySlider" onchange="toggleIncomePeriod(this)">
                                </div>
                            </div>
                            <!-- Future Values/In Today's Money Switch -->
                            <div class="d-flex justify-content-between align-items-center mb-3 p-2">
                                <label class="form-check-label me-3" for="futurePresentSwitch">Future Values / In Today's Money</label>
                                <div class="form-check form-switch ms-auto pe-2">
                                    <input class="form-check-input" type="checkbox" id="applyInflationAdjustmentPhone" onchange="toggleValuePerspective(this)">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Nested Accordion -->
        </div>

    </div> 

    

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="model.js"></script>
    <script src="input-listeners-phone.js"></script>
    <script>

        // Get all input fields - THIS LISTENS FOR ANY CLICKS
        var inputFields = document.querySelectorAll('input');

        // Add event listeners to hide results on input change
      /*   inputFields.forEach(function(input) {
                input.addEventListener('input', saveAndCalc());
            }
        ); */

        function saveAndCalc() {
            
            saveToLocalStorage("planAsCouple", false);
            saveInputsToLocalStoragePhone(); 
            saveSlidersToLocalStorage();
            /* validateInputs(false,false,true);  */  //planAsCouple,AlreadyRetired,phoneFormat
            calculateMyPension(true);
           /*  showResults(); */

        }

       /*  function showResults() {
            const resultsSection = document.getElementById("resultsSection");
            resultsSection.classList.remove("d-none");
        } */

        function selectOption(option) {
            // Get all toggle options
            const toggleOptions = document.querySelectorAll('.toggle-option');

            // Remove 'active' class from all options
            toggleOptions.forEach(optionElement => optionElement.classList.remove('active'));

            // Add 'active' class to the selected option
            const selectedElement = document.querySelector(`.toggle-option.${option}`);
            selectedElement.classList.add('active');

            // Update the displayed selected option
            const selectedOptionDisplay = document.getElementById('selectedOption');
            selectedOptionDisplay.textContent = option.charAt(0).toUpperCase() + option.slice(1);
        }


        function toggleIncomePeriod(switchElement) {
            saveAndCalc();
            if (switchElement.checked) {
                console.log("Switched to Monthly Income");
            } else {
                console.log("Switched to Yearly Income");
            }
        }

        function toggleValuePerspective(switchElement) {
            saveAndCalc();
            if (switchElement.checked) {
                console.log("Switched to Future Values");
            } else {
                console.log("Switched to In Today's Money");
            }
        }

     
        function formatNumber(value) {
            return new Intl.NumberFormat('en-GB').format(value);
        }

        // Function to update the output box value dynamically based on the slider's position
        function updateOutput(outputId, value, formatWithCommas) {
            const outputElement = document.getElementById(outputId);
            if (formatWithCommas) {
                outputElement.textContent = formatNumber(value);
            } else {
                // For values that don't require formatting (like age or percentage)
                outputElement.textContent = value;
                
            }
            saveAndCalc();
        }

        function saveInputsToLocalStoragePhone() {
            for (const [inputId, valueId] of Object.entries(inputToValueMap)) {
                const outputElement = document.getElementById(inputId);
                if (outputElement) {
                    const rawValue = outputElement.textContent.replace(/,/g, '').replace('%', ''); // Remove formatting (commas, %)
                    saveToLocalStorage(valueId, rawValue);
                    
                }
            }
        }

        function saveSlidersToLocalStorage() {
            for (const [sliderId, outputId] of Object.entries(sliderToOutputMap)) {
                const outputElement = document.getElementById(outputId);
                if (outputElement) {
                    const rawValue = outputElement.textContent.replace(/,/g, '').replace('%', ''); // Remove formatting (commas, %)
                    saveToLocalStorage(sliderId, rawValue);
                    saveToLocalStorage(outputId, rawValue);
                }
            }
        }

        // Helper function to save a single value to localStorage
        function saveToLocalStorage(key, value) {
            localStorage.setItem(key, value);
        }


        const sliderToOutputMap = {
            'currentAgeSlider': 'currentAgePhone',
            'currentFundSlider': 'currentFundPhone',
            'currentISASlider': 'currentISAPhone',
            'monthlyPensionContributionsSlider': 'inputMonthlyContributionPhone',
            'monthlyISADepositsSlider': 'inputMonthlyISAContributionPhone',
            'annualPensionSlider': 'dbPensionAmountPhone',
            'pensionPayableAgeSlider': 'dbPensionAgePhone',
            'desiredIncomeSlider': 'inputDesiredIncomePhone',
            'retirementAgeSlider': 'inputRetirementAgePhone',
            'taxFreeCashSlider': 'inputTaxFreeCashPercentPhone',
            'fundGrowthSlider': 'fundGrowthPhone',       // Added
            'inflationSlider': 'inflationPhone',         // Added
            'fundChargesSlider': 'fundChargesPhone'      // Added
        };


        const inputToValueMap = {
            'currentAgePhone': 'currentAge',
            'currentFundPhone': 'currentFund',
            'currentISAPhone': 'currentISA',
            'inputMonthlyContributionPhone': 'monthlyContribution',
            'inputMonthlyISAContributionPhone': 'monthlyISAContribution',
            'dbPensionAmountPhone': 'dbPensionAmount',
            'dbPensionAgePhone': 'dbPensionAge',
            'inputDesiredIncomePhone': 'desiredIncome',
            'inputRetirementAgePhone': 'retirementAge',
            'inputTaxFreeCashPercentPhone': 'taxFreeCashPercent',
            'fundGrowthPhone': 'fundGrowthPre',             // Added
            'inflationPhone': 'inflation',               // Added
            'fundChargesPhone': 'fundCharges'            // Added
        };


        // Example function to retrieve raw values for calculations
        function getRawValue(outputId) {
            const outputElement = document.getElementById(outputId);
            if (outputElement) {
                if (
                    outputId === 'currentAgePhone' ||
                    outputId === 'dbPensionAgePhone' ||
                    outputId === 'inputRetirementAgePhone' ||
                    outputId === 'inputTaxFreeCashPercentPhone' ||
                    outputId === 'fundGrowthPhone' ||
                    outputId === 'inflationPhone' ||
                    outputId === 'fundChargesPhone'
                ) {
                    return parseInt(outputElement.textContent, 10);
                } else {
                    // Remove commas for numerical values
                    return parseInt(outputElement.textContent.replace(/,/g, ''), 10);
                }
            }
            saveAllInputsToLocalStoragePhone();
            return 0;
        }


        // Initialize sliders with saved values on page load
        document.addEventListener("DOMContentLoaded", function() {
            loadSlidersFromLocalStorage();
            saveAndCalc();
        });


        // Function to load slider values from localStorage and initialize sliders and outputs
        function loadSlidersFromLocalStorage() {
            for (const [sliderId, outputId] of Object.entries(sliderToOutputMap)) {
                const savedValue = localStorage.getItem(sliderId);
                if (savedValue !== null) {
                    const slider = document.getElementById(sliderId);
                    const output = document.getElementById(outputId);
                    if (slider && output) {
                        slider.value = savedValue;
                        // Update the output box based on whether formatting is needed
                        if (
                            outputId === 'currentAgePhone' ||
                            outputId === 'dbPensionAgePhone' ||
                            outputId === 'inputRetirementAgePhone' ||
                            outputId === 'inputTaxFreeCashPercentPhone' ||
                            outputId === 'fundGrowthPhone' ||
                            outputId === 'inflationPhone' ||
                            outputId === 'fundChargesPhone'
                        ) {
                            output.textContent = savedValue;
                        } else {
                            output.textContent = formatNumber(savedValue);
                        }
                    }
                }
            }
        }

        



        function updateRetirementLivingStandardsSelector(event) {

            const selectedValue = event.target.value;
            console.log(`Selected: ${selectedValue}`);

            var target = document.getElementById("desiredIncomeSlider");
            //Single income only for phone
            var values = {
                Minimum: parseInt(14400/12/10)*10,
                Moderate: parseInt(31300/12/10)*10,
                Comfortable: parseInt(43100/12/10)*10
            }


            // Perform an action based on the selected value
            if (selectedValue === "Option 1") {
            target.value = parseInt(values.Minimum);
            } else if (selectedValue === "Option 2") {
            target.value = parseInt(values.Moderate);
            } else if (selectedValue === "Option 3") {
            target.value = parseInt(values.Comfortable);
            }

            updateOutput("inputDesiredIncomePhone", target.value)
            localStorage.setItem('selectedRetirementIncomeStandardOption', selectedValue);
            saveAllInputsToLocalStoragePhone();
            saveAndCalc();

        }
       
    </script>
    
</body>
</html>
